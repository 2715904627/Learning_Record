# Day3

### ·OS learning, Assembly language

### ·videos：滴水三期，01-15(通用寄存器_内存读写)

### ·books: x86汇编语言 从实模式到保护模式 (李忠 王晓波 余洁) \汇编语言（第4版） (王爽) 

##### 32位通用寄存器

|      | 寄存器 |      | 编号(二进制) | 编号(十进制) |
| ---- | ------ | ---- | ------------ | ------------ |
| 32位 | 16位   | 8位  |              |              |
| EAX  | AX     | AL   | 000          | 0            |
| ECX  | CX     | CL   | 001          | 1            |
| EDX  | DX     | DL   | 010          | 2            |
| EBX  | BX     | BL   | 011          | 3            |
| ESP  | SP     | AH   | 100          | 4            |
| EBP  | BP     | CH   | 101          | 5            |
| ESI  | SI     | DH   | 110          | 6            |
| EDI  | DI     | BH   | 111          | 7            |

![image-20240708224002344](C:\Users\Tlaloc\AppData\Roaming\Typora\typora-user-images\image-20240708224002344.png)

###### 32位寄存器是计算机一步一步发展而来的，结构很有历史痕迹

以EAX为例：

EAX的高位为扩展的16位寄存器，低位为AX寄存器（16位），而AX寄存器又是由两个8位寄存器组成的，高位为AH，低位为AL，所以在EAX中，可以很方便的操作低位数据，尤其是8位数据，但是在高16位不太容易直接操作

EAX,ECX,EDX,EBX皆是如此，在32位处理器中，还添加了ESP\EBP\ESI\EDI这四个寄存器，他们没有8位寄存器组成，只有一个没有扩展的16位寄存器加上扩展寄存器组成。

在汇编指令中，数据宽度不能超出容器限制

###### 32位代表着什么

可以想象计算机内有32根线连接着cpu，这32根线可以表示从00000000到FFFFFFFF的所有数字，所有情况共同连接着一块内存条，而每个数字直接编号为内存的地址，这样，一块内存条最多就可以存储2^32种信号，即4Gb种信息，所以32位系统的内存通常为4Gb。而现在的64位操作系统的寻址方式就有根本数不完的内存空间，现在的内存技术完全达不到这种量级，所以通常情况下64位操作系统有用户态和内核态两种寻址方式，在一般情况下使用48根总线来寻址，即使这样，要达到完全利用的话，需要二百多Tb的内存，这是完全溢出的。

留白：在早期32位系统中，4Gb内存通常不足以完成一些任务，所以有厂商想出了特殊的方式来拓展内存，很出名的一种是PAE

###### DtDEBUG内存表示W

![image-20240708225039541](C:\Users\Tlaloc\AppData\Roaming\Typora\typora-user-images\image-20240708225039541.png)

如图所示，尽管1块内存存储着一个字节的数据，但是为了表示方便，DTDEBUG中直接将四块内存拼到一起表示，0019FF78和0019FF7C相差4个地址。在数据的表示上，从低位到高位一个字节1组依次表示一块内存数据，例：002C7000中，00表示19FF7C，70表示19FF7D，2C表示19FF7E,00表示19FF7F

###### MOV 语法					


1、MOV r/m8,r8 				r 通用寄存器	
					
2、MOV r/m16,r16				m 代表内存	
					
3、MOV r/m32,r32				imm 代表立即数	
					
4、MOV r8,r/m8				r8 代表8位通用寄存器	
					
5、MOV r16,r/m16				m8 代表8位内存	
					
6、MOV r32,r/m32				imm8 代表8位立即数	
					
7、MOV r8, imm8					
					
8、MOV r16, imm16					
					
9、MOV r32, imm32					
					

MOV 目标操作数，源操作数				
				
作用：拷贝源操作数到目标操作数				
				
1、源操作数可以是立即数、通用寄存器、段寄存器、或者内存单元.								
2、目标操作数可以是通用寄存器、段寄存器或者内存单元.				
				
3、操作数的宽度必须一样.				
				
4、源操作数和目标操作数不能同时为内存单元.	

#### 在这个2*3的表格中，唯一不互通的只有内存-内存这条线			

###### ADD和SUB语法

总体和MOV类似，但是需要注意的是进位借位问题

#### 进位和借位只发生在指定的数据宽度内的数据中，不涉及其他位

例如：如果EAX里为0XFFFFFFFF

若指令为：ADD EAX,0X1

则,EAX:0X00000000

若指令为：ADD AX,0X1

则,EAX:0XFFFF0000

若指令为：ADD AH,0X1

则,EAX:0XFFFF00FF

若指令为：ADD AL,0X1

则,EAX:0XFFFFFF00



类似的，如果EAX里为0X00000100

若指令为：SUB AL,0X1

则,EAX:0X000001FF

若指令为：SUB AX,0X1

则,EAX:0X000000FF



###### 逻辑运算语法

和以上语法类似，需要特别注意的是not，只能操作容器内的数据

NOT r/m8

NOT r/m16

NOT r/m32